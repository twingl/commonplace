<div tabindex="0" ui-keydown="{37: 'keyPress($event)', 39: 'keyPress($event)'}"> <!-- TODO: disable when in search box -->

  <div class="search">
    <form class="search__form" ng-submit="search(searchTerm)">
      <div class="search-box">
        <i class="icon-search search-box__icon"></i>
        <input type="search" class="search-box__input" ng-model="searchTerm" tabindex="1" autofocus>
      </div>
    </form>
    <div class="search-results" ng-show="showSearchResults">
      <div class="search--hide"><i class="icon-collapse-top icon-2x" ng-click="showSearchResults = false; searchTerm = ''"></i></div>
      <div class="search-results--notice" ng-show="showSearchNotice">
          <h3>... There were no results matching your search term.</h3>
      </div>
      <div class="search-results__list" masonry>
        <div class="card card--min masonry-brick" ng-repeat="result in searchResults">
          <div class="card__quote card__quote--min">{{result.quote}}</div>
          <div class="card__attribution card__attribution--min">&mdash; <a href="{{result.context_url}}">{{result.context_url | ShortenedURL}}</a></div>
          <div class="card__comment card__comment--min" ng-repeat="comment in result.comments">{{comment.body}} <hr></div>
          <div class="card__actions card__actions--min">
            <i class="icon-reply-all card--jump" ng-click="navigateTo(result.created)"></i>
            <div class="card__twinglings">
              <i class="icon-code-fork search-results_twingling" ng-click="showTwinglings(result.id)"></i>
              <sup>{{twinglingCount(result.twinglings.length)}}</sup>
              <div class="card__connect--swing" ng-class="{ 'animated swing': twinglingAnimate(result.id, $index) }">
                <i class="icon-bolt card__connect" ng-class="{ 'card__connect--swing__start' : twinglingStart(result.id, $index), 'card__connect--swing__end' : twinglingEnd(result.id, $index) }" ng-click="newTwingling('results', result.id, $index)"></i>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>


  <div class="commonplace__container">

    <div class="navigation">
      <div class="navigation navigation__back">
        <i class="icon-chevron-left icon-3x" ng-click="flickBackOnePage()"></i>
      </div>
      <div class="navigation navigation__forward">
        <i class="icon-chevron-right icon-3x" ng-click="flickForwardOnePage()"></i>
      </div>
    </div>

    <div class="content" masonry>
      <div class="card masonry-brick" ng-repeat="highlight in highlights | filter:inTimeSlice | orderBy:'-created'">
        <i class="icon-remove card--remove" ng-click="deleteHighlight($index, highlight.id)"></i>
        <blockquote class="card__quote">{{highlight.quote}}</blockquote>
        <div class="card__attribution">&mdash; <a href="{{highlight.context_url}}">{{highlight.context_url | ShortenedURL}}</a></div>
        <div class="card__comment" ng-repeat="comment in highlight.comments">{{comment.body}} <hr></div>
        <div class="card__actions">
          <div class="card__show-comments">
            <i class="icon-plus" ng-click="comment.showThis = !comment.showThis"></i>
          </div>
          <div class="card__twinglings">
            <i class="icon-code-fork" ng-click="showTwinglings(highlight.id)"></i>
            <sup>{{twinglingCount(highlight.twinglings.length)}}</sup>
            <div class="card__connect--swing" ng-class="{ 'animated swing': twinglingAnimate(highlight.id, $index) }">
              <i class="icon-bolt card__connect" ng-class="{ 'card__connect--swing__start' : twinglingStart(highlight.id, $index), 'card__connect--swing__end' : twinglingEnd(highlight.id, $index) }" ng-click="newTwingling('highlights', highlight.id, $index)"></i>
            </div>
          </div>
        </div>
        <div class="new-comment" ng-show="comment.showThis">
          <textarea class="new-comment__body" ng-model="comment.new"></textarea>
          <button class="new-comment__submit" ng-click="addComment($index, highlight.id, comment.new); comment.showThis = !comment.showThis">Add Comment</button>
        </div>
      </div>
    </div>

  </div>

</div>